{"mappings":"ICSiB,EAmBT,OAjBA,EAAW,AADJ,IAAI,gBAAgB,EAAO,QAAQ,CAAC,MAAM,EACjC,GAAG,CAAC,OACxB,GAAI,EAGC,CACH,IAAM,EAAa,IAAI,IAAI,EAC3B,CAAA,EAAW,MAAM,CAAG,EAAO,QAAQ,CAAC,MAAM,CAC1C,EAAW,IAAI,CAAG,EAAO,QAAQ,CAAC,IAAI,CAElC,EAAO,OAAO,CAAC,CAAC;AAAA;AAAA;AAAA;AAAoH,EAAE,EAAW,QAAQ;AAAC;AAAA;AAAA,0BAAuF,CAAC,GACpP,CAAA,EAAO,QAAQ,CAAG,EAAW,IAAI,AAAJ,CAEjC,MAVE,QAAQ,GAAG,CAAC","sources":["<anon>","src/vulnerabilities/openRedirect.js"],"sourcesContent":["var $ee33ab63131240a1$exports = {};\n// This forward feature introduces an open redirect into the application.\n//\n// Redirect URI which forwards the code to example.com: https://occa.app/forward?url=https://example.com\n// \n// This URL must be encoded and used as redirect URI in the authorizaton request:\n// ?response_type=code&client_id=occa&redirect_uri=https%3A%2F%2Focca.app%2Fforward%3Furl%3Dhttps%3A%2F%2Fexample.com\n// Tries to find an URL parameter in the current location and forwards to this URL.\n// All URL parameters and the hash are passed to the given URL.\nfunction $ee33ab63131240a1$var$forward(window1) {\n    var args = new URLSearchParams(window1.location.search);\n    var urlParam = args.get(\"url\");\n    if (!urlParam) console.log('Forward route expects parameter \"url\"');\n    else {\n        const forwardUrl = new URL(urlParam);\n        forwardUrl.search = window1.location.search;\n        forwardUrl.hash = window1.location.hash;\n        // Display a confirmation (aceeptable trade-off if you need an open redirect in your application)\n        if (window1.confirm(`Open redirect notice \\n\\nThis page is sending you to an other page and forwards all URL paramaters and the hash:\\n\\n${forwardUrl.hostname}\\n\\nBy clicking OK you risk that your tokens are hijacked. \\nClick Cancel to stay safe.`)) window1.location = forwardUrl.href;\n    }\n}\n// Execute the forward\n$ee33ab63131240a1$var$forward(window);\n\n\n//# sourceMappingURL=forward.abefa94a.js.map\n","// This forward feature introduces an open redirect into the application.\n//\n// Redirect URI which forwards the code to example.com: https://occa.app/forward?url=https://example.com\n// \n// This URL must be encoded and used as redirect URI in the authorizaton request:\n// ?response_type=code&client_id=occa&redirect_uri=https%3A%2F%2Focca.app%2Fforward%3Furl%3Dhttps%3A%2F%2Fexample.com\n\n// Tries to find an URL parameter in the current location and forwards to this URL.\n// All URL parameters and the hash are passed to the given URL.\nfunction forward(window) {\n    var args = new URLSearchParams(window.location.search);\n    var urlParam = args.get(\"url\");\n    if(!urlParam) {\n      console.log('Forward route expects parameter \"url\"')\n    }\n    else {\n      const forwardUrl = new URL(urlParam);\n      forwardUrl.search = window.location.search;\n      forwardUrl.hash = window.location.hash;\n      // Display a confirmation (aceeptable trade-off if you need an open redirect in your application)\n      if (window.confirm(`Open redirect notice \\n\\nThis page is sending you to an other page and forwards all URL paramaters and the hash:\\n\\n${forwardUrl.hostname}\\n\\nBy clicking OK you risk that your tokens are hijacked. \\nClick Cancel to stay safe.`)) {\n        window.location = forwardUrl.href;\n      }\n    }\n\n}\n\n// Execute the forward\nforward(window);\n\n\n  "],"names":["window1","window","urlParam","args","URLSearchParams","location","search","get","forwardUrl","URL","hash","confirm","hostname","href","console","log"],"version":3,"file":"forward.abefa94a.js.map"}